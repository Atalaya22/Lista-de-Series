<main class="page">
  <app-topbar></app-topbar>

  <section class="hero">
    <div class="hero-copy">
      <p class="eyebrow">Actualidad</p>
      <h1>Tu memoria audiovisual, ordenada por emociones.</h1>
      <p class="lead">
        Guarda lo que ves, como te hizo sentir y por que vale la pena recordarlo. Un diario intimo
        para volver a tus escenas favoritas.
      </p>
      <div class="quick-stats">
        <div class="stat-card">
          <p class="stat-value">{{ moviesCount }}</p>
          <p class="stat-label">Peliculas vistas</p>
        </div>
        <div class="stat-card">
          <p class="stat-value">{{ seriesCount }}</p>
          <p class="stat-label">Series seguidas</p>
        </div>
        <div class="stat-card">
          <p class="stat-value">{{ averageRating.toFixed(1) }}</p>
          <p class="stat-label">Promedio personal</p>
        </div>
      </div>
    </div>

    <app-quick-entry-form (entrySaved)="addEntry($event)"></app-quick-entry-form>
  </section>

  <section class="grid">
    <div class="column">
      <section class="latest-movie-card">
        <div class="latest-movie-text">
          <p class="eyebrow">Ultima pelicula vista</p>
          @if (latestMovie) {
            <h2 class="latest-movie-title">{{ latestMovie.title }}</h2>
            <p class="latest-movie-meta">
              Vista el {{ formatEntryDate(latestMovie.date) }} Â· {{ latestMovie.rating }} / 5
            </p>
            <p class="latest-movie-note">{{ latestMovie.notes }}</p>
          } @else {
            <h2 class="latest-movie-title">Aun no hay peliculas</h2>
            <p class="latest-movie-meta">Agrega una entrada para ver la caratula.</p>
          }
        </div>
        <div class="latest-movie-poster">
          @if (latestMoviePosterState === 'loading') {
            <div class="poster-placeholder">Cargando caratula...</div>
          } @else if (latestMoviePosterState === 'error') {
            <div class="poster-placeholder">
              {{ latestMoviePosterMessage || 'No se pudo cargar la caratula.' }}
            </div>
          } @else if (latestMoviePosterUrl) {
            <img [src]="latestMoviePosterUrl" [alt]="latestMoviePosterAlt" loading="lazy" />
          } @else {
            <div class="poster-placeholder">Sin caratula.</div>
          }
        </div>
      </section>
      <app-entries [entries]="entries"></app-entries>
    </div>

    <aside class="column side">
      <app-section-header title="Resumen del mes" actionLabel="Cambiar mes"></app-section-header>
      <app-highlights [items]="highlights"></app-highlights>
      <app-mood-board title="Mapa de emociones" [moods]="moodBoard"></app-mood-board>

      <app-pending-list [title]="Pendientes" [items]="items"></app-pending-list>
    </aside>
  </section>
</main>

<router-outlet />
